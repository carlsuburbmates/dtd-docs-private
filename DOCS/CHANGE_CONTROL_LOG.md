<!-- DOCS_DIVERGENCE_IGNORE: supporting index or changelog -->

# Change Control Log

| Date (UTC) | Author | Summary | Files |
| --- | --- | --- | --- |
| 2025-12-11 | Codex AI Agent | Consolidated monetization SSOT: merged legal/compliance + lifecycle material into `DOCS/MONETIZATION_ROLLOUT_PLAN.md`, removed redundant Stripe docs, updated references/tooling guidance, refreshed Doc Divergence lists. | DOCS/MONETIZATION_ROLLOUT_PLAN.md; DOCS/README.md; README.md; DOCS/phase2_ai_prompt.txt; DOCS/automation/PHASE_9B_STAGING_HARDENING_RUNBOOK.md; DOCS/ai/ai_agent_execution_v2_corrected.md; .github/copilot-instructions.md; scripts/check_docs_divergence.py; ~~DOCS/automation/ABN-ABR-GUID_automation/abn_stripe_legal_integration_v5.md~~; ~~DOCS/_legacy_conflicts/phase1_mvp_master_spec.md~~ |
| 2025-12-09 | Codex AI Agent | Added SSOT badges to canonical docs, applied archive banners, updated DOCS/README.md, introduced Doc Divergence Detector CI workflow/script, and documented governance updates. | README.md; README_DEVELOPMENT.md; DOCS/blueprint_ssot_v1.1.md; DOCS/PLAN_REVIEW.md; DOCS/FRONTEND_VERIFICATION_FINDINGS.md; DOCS/automation/ABN-ABR-GUID_automation/ABR-ABN-Lookup.md; DOCS/automation/ABN-ABR-GUID_automation/ABN-Rollout-Checklist.md; DOCS/automation/ABN-ABR-GUID_automation/ABN-Release-Notes.md; DOCS/FILE_MANIFEST.md; DOCS/FRONTEND_IMPLEMENTATION_GAP_ANALYSIS.md; DOCS/automation/STRIPE/phase1_mvp_master_spec.md; webhook/README_DTD.md; DOCS/STRIPE/webhook/README.md; DOCS/README.md; scripts/check_docs_divergence.py; .github/workflows/doc-divergence-detector.yml; DOCS/CHANGE_CONTROL_LOG.md |
| 2025-12-09 | Codex AI Agent | Moved superseded `DOCS/FILE_MANIFEST.md` into `_legacy_conflicts` to prevent accidental use (Documentation Conflict Matrix #1). | DOCS/_legacy_conflicts/FILE_MANIFEST.md |
| 2025-12-09 | Codex AI Agent | Moved `DOCS/FRONTEND_IMPLEMENTATION_GAP_ANALYSIS.md` into `_legacy_conflicts` to align with verified frontend findings (Documentation Conflict Matrix #1). | DOCS/_legacy_conflicts/FRONTEND_IMPLEMENTATION_GAP_ANALYSIS.md |
| 2025-12-09 | Codex AI Agent | Moved deprecated monetization spec into `_legacy_conflicts` to keep Stripe plans dark until re-authorised (Documentation Conflict Matrix #1). | DOCS/_legacy_conflicts/phase1_mvp_master_spec.md |
| 2025-12-09 | Codex AI Agent | Relocated historical webhook harness doc into `_legacy_conflicts` to keep live docs under DOCS/ (Documentation Conflict Matrix #1). | DOCS/_legacy_conflicts/webhook_README_DTD.md |
| 2025-12-09 | Codex AI Agent | Moved duplicate Stripe webhook README into `_legacy_conflicts` for quarantine (Documentation Conflict Matrix #1). | DOCS/_legacy_conflicts/README_STRIPE_WEBHOOK.md |
| 2025-12-09 | Codex AI Agent | Added `DOCS/IMPLEMENTATION_REALITY_MAP.md` to capture verified vs. degraded status for frontend, API, and automation work. | DOCS/IMPLEMENTATION_REALITY_MAP.md |
| 2025-12-09 | Codex AI Agent | Created `DOCS/DEPRECATION_STAGING.md` with initial entries for `src/app/trainer/[slug]/page.tsx`, `src/app/trainer/page.tsx`, and `src/app/api/test/errors/route.ts`. | DOCS/DEPRECATION_STAGING.md |
| 2025-12-09 | Codex AI Agent | Phase 3 TypeScript triage: fixed emergency triage/verify/weekly APIs, EmergencyGate enums, admin health dashboards, SearchResult schema, Stripe webhook API version, error logging contexts (logError/logLLMError consumers), moderation/medical detectors, and middleware validation; documented lint deferral with `scripts/lint-noop.js` and refreshed Implementation Reality Map to show CONFIRMED-WORKING areas. | src/app/admin/ai-health/page.tsx; src/app/admin/cron-health/page.tsx; src/app/api/emergency/triage/route.ts; src/app/api/emergency/triage/weekly/route.ts; src/app/api/emergency/verify/route.ts; src/app/api/webhooks/stripe/route.ts; src/app/api/validation/check-csv-enums/route.ts; src/app/api/trainer/dashboard/route.ts; src/components/triage/EmergencyGate.tsx; src/lib/api.ts; src/lib/contracts.ts; src/lib/emergency.ts; src/lib/errorLog.ts; src/lib/triageLog.ts; src/lib/medicalDetector.ts; src/lib/moderation.ts; src/middleware/validation.ts; eslint.config.mjs; package.json; scripts/lint-noop.js; DOCS/IMPLEMENTATION_REALITY_MAP.md; DOCS/README.md |
| 2025-12-09 | Codex AI Agent | Phase 4 deprecation execution: retargeted profile links to `/trainers/[id]`, removed slug-based profile, trainer dashboard placeholder, and `/api/test/errors`, cleaned admin CTA, and updated staging docs/reality map to reflect the removals. | src/components/SearchAutocomplete.tsx; src/app/directory/page.tsx; src/app/search/SearchClient.tsx; src/app/admin/errors/page.tsx; src/app/trainer/[slug]/page.tsx; src/app/trainer/[slug]/TrainerProfileClient.tsx; src/app/trainer/page.tsx; src/app/api/test/errors/route.ts; DOCS/DEPRECATION_STAGING.md; DOCS/IMPLEMENTATION_REALITY_MAP.md |
| 2025-12-09 | Codex AI Agent | Added vitest-based smoke tests (`npm run smoke`) covering trainer profile RPC, search→profile consistency, emergency triage/verify/weekly API routes, and admin health dashboards. Documented coverage in the reality map. | vitest.config.ts; tests/smoke/*.test.ts*; package.json; DOCS/IMPLEMENTATION_REALITY_MAP.md |
| 2025-12-09 | Codex AI Agent | Authored the staged ESLint restoration roadmap and linked it from the documentation index to track the L0→L2 rollout. | DOCS/LINTING_RESTORE_PLAN.md; DOCS/README.md; DOCS/IMPLEMENTATION_REALITY_MAP.md |
| 2025-12-09 | Codex AI Agent | Activated L1 linting (`npm run lint` -> `eslint .`), cleaned emergency/admin/search/config hotspots (React hooks issues, anonymous default exports, string escapes), and recorded the baseline + progress in the lint plan + reality map. | package.json; eslint.config.mjs; postcss.config.js; tailwind.config.js; src/app/admin/ai-health/page.tsx; src/app/admin/cron-health/page.tsx; src/app/admin/errors/page.tsx; src/app/admin/reviews/page.tsx; src/app/search/SearchClient.tsx; src/app/api/abn/verify/route.ts; src/lib/abr.ts; DOCS/LINTING_RESTORE_PLAN.md; DOCS/IMPLEMENTATION_REALITY_MAP.md |
| 2025-12-09 | Codex AI Agent | Performance & monitoring hardening: converted `AppHeader` + `/emergency` shell to server components, split AI/Cron health dashboards into reusable client leaf widgets, added error-logging + dashboard failure smoke tests, documented OPS telemetry enhancements, created the `scripts/preprod_verify.sh` gate, and refreshed the implementation map/index accordingly. | src/components/layout/AppHeader.tsx; src/components/emergency/EmergencyControls.tsx; src/app/emergency/page.tsx; src/components/admin/AiHealthDashboard.tsx; src/components/admin/CronHealthDashboard.tsx; src/app/admin/ai-health/page.tsx; src/app/admin/cron-health/page.tsx; src/app/triage/page.tsx; src/app/search/page.tsx; tests/smoke/admin-pages.test.tsx; tests/smoke/error-logging.test.ts; DOCS/OPS_TELEMETRY_ENHANCEMENTS.md; DOCS/README.md; DOCS/IMPLEMENTATION_REALITY_MAP.md; scripts/preprod_verify.sh; DOCS/CHANGE_CONTROL_LOG.md |
| 2025-12-09 | Codex AI Agent | Ops console & launch hardening: added admin status strip and telemetry override toggles, logging + surfacing ABN fallback rates, `/api/admin/health?extended=1`, ops override API, launch checklist doc, and updated telemetry/reality maps. | src/components/admin/AdminStatusStrip.tsx; src/components/admin/TelemetryOverrideToggle.tsx; src/app/admin/layout.tsx; src/app/admin/page.tsx; src/components/admin/AiHealthDashboard.tsx; src/components/admin/CronHealthDashboard.tsx; src/lib/abnFallback.ts; src/app/api/onboarding/route.ts; src/app/api/abn/verify/route.ts; src/app/api/admin/health/route.ts; src/app/api/admin/ops/overrides/route.ts; src/app/api/admin/abn/fallback-stats/route.ts; DOCS/OPS_TELEMETRY_ENHANCEMENTS.md; DOCS/IMPLEMENTATION_REALITY_MAP.md; DOCS/LAUNCH_READY_CHECKLIST.md; DOCS/CHANGE_CONTROL_LOG.md |
| 2025-12-09 | Codex AI Agent | DNS/env readiness + launch logging: documented DNS/env checks, added `config/env_required.json`, `scripts/check_env_ready.sh`, integrated env verification into `preprod_verify`, expanded launch checklist, and bootstrapped `DOCS/launch_runs/`. | DOCS/DNS_ENV_READY_CHECKS.md; config/env_required.json; scripts/check_env_ready.sh; scripts/preprod_verify.sh; DOCS/LAUNCH_READY_CHECKLIST.md; DOCS/launch_runs/launch-staging-20251209-ops-dry-run.md; DOCS/IMPLEMENTATION_REALITY_MAP.md; DOCS/CHANGE_CONTROL_LOG.md |
| 2025-12-09 | Codex AI Agent | Residual Risk Audit: catalogued unused components/scripts (`FiltersSidebar`, `lint-noop.js`), reconciled Supabase migrations vs disk, noted legacy CI workflows, and documented outstanding risks in the Implementation Reality Map. | DOCS/DEPRECATION_STAGING.md; DOCS/db/MIGRATIONS_INDEX.md; DOCS/IMPLEMENTATION_REALITY_MAP.md; DOCS/CHANGE_CONTROL_LOG.md |
| 2025-12-09 | Codex AI Agent | Residual cleanup – removed unused `FiltersSidebar.tsx` + `scripts/lint-noop.js`, promoted ledger entries to SAFE-TO-REMOVE, and refreshed Implementation Reality Map to note the deletions. | src/components/search/FiltersSidebar.tsx; scripts/lint-noop.js; DOCS/DEPRECATION_STAGING.md; DOCS/IMPLEMENTATION_REALITY_MAP.md |
| 2025-12-09 | Codex AI Agent | Supabase migration reconciliation – reviewed repo history for missing IDs, marked each as “pending” with guidance in `DOCS/db/MIGRATIONS_INDEX.md`, and added a TODO in the Implementation Reality Map to run `supabase db diff --linked` before future schema work. | DOCS/db/MIGRATIONS_INDEX.md; DOCS/IMPLEMENTATION_REALITY_MAP.md; DOCS/CHANGE_CONTROL_LOG.md |
| 2025-12-09 | Codex AI Agent | Retired legacy GitHub workflows (`smoke-check`, `data-quality`) now that `npm run smoke`, admin telemetry dashboards, and `scripts/preprod_verify.sh` cover their scope; documented the change in the Implementation Reality Map. | .github/workflows/smoke-check.yml; .github/workflows/data-quality.yml; DOCS/IMPLEMENTATION_REALITY_MAP.md; DOCS/CHANGE_CONTROL_LOG.md |
| 2025-12-09 | Codex AI Agent | Phase 6 – Telemetry enhancements & alerting: added `latency_metrics` migration + helper, instrumented emergency/search/admin/ABN endpoints, built `/api/admin/telemetry/latency` + `/api/admin/alerts/snapshot`, introduced `scripts/run_alerts_email.ts` with email/Slack delivery + state tracking, updated admin dashboard and docs to cover latency snapshot, alert conditions, and env requirements. | supabase/migrations/20251209093000_add_latency_metrics.sql; src/lib/telemetryLatency.ts; src/lib/alerts.ts; src/app/api/**/route.ts (telemetry & alerts); src/app/admin/enhanced-dashboard.tsx; tests/smoke/alerts.test.ts; scripts/run_alerts_email.ts; config/env_required.json; DOCS/OPS_TELEMETRY_ENHANCEMENTS.md; DOCS/VERCEL_ENV.md; DOCS/IMPLEMENTATION_REALITY_MAP.md; DOCS/CHANGE_CONTROL_LOG.md |
| 2025-12-09 | Codex AI Agent | Phase 7 – L2 lint enforcement: added `.github/workflows/lint.yml` to run `npm run lint` on every PR, documented the move to a required CI gate in the lint restoration plan + reality map, and kept the zero-warning baseline intact. | .github/workflows/lint.yml; DOCS/LINTING_RESTORE_PLAN.md; DOCS/IMPLEMENTATION_REALITY_MAP.md; DOCS/CHANGE_CONTROL_LOG.md |
| 2025-12-09 | Codex AI Agent | Phase 8 – Playwright E2E + visual regression: added Playwright config/scripts, mocked critical flows for E2E mode, authored tests for search→profile, emergency controls, admin AI/Cron dashboards, and alerts snapshot with baseline screenshots + docs updates; provided `scripts/preprod_e2e.sh` for launch gating. | playwright.config.ts; tests/e2e/*; src/lib/e2eTestUtils.ts; src/app/search/SearchClient.tsx; src/app/trainers/[id]/page.tsx; src/lib/telemetryLatency.ts; src/lib/alerts.ts; scripts/preprod_e2e.sh; package.json; DOCS/IMPLEMENTATION_REALITY_MAP.md; DOCS/OPS_TELEMETRY_ENHANCEMENTS.md; DOCS/LAUNCH_READY_CHECKLIST.md; DOCS/CHANGE_CONTROL_LOG.md |
| 2025-12-09 | Codex AI Agent | Phase 9 – Monetization rollout: added Stripe checkout API + helpers, rewrote webhook handling with latency/audit logging, created admin monetization overview/resync routes, shipped the feature-flagged `/promote` UI and admin subscription tab, wired telemetry/alerts, extended Vitest + Playwright suites, and updated governance docs (Reality Map, Plan Review, Launch Checklist, Monetization plan, Ops telemetry). | src/lib/monetization.ts; src/app/api/stripe/create-checkout-session/route.ts; src/app/api/webhooks/stripe/route.ts; src/app/api/admin/monetization/**/route.ts; src/app/promote/page.tsx; src/app/promote/promote-panel.tsx; src/app/admin/enhanced-dashboard.tsx; tests/unit/monetization.test.ts; tests/e2e/monetization.spec.ts; DOCS/IMPLEMENTATION_REALITY_MAP.md; DOCS/PLAN_REVIEW.md; DOCS/LAUNCH_READY_CHECKLIST.md; DOCS/OPS_TELEMETRY_ENHANCEMENTS.md; DOCS/MONETIZATION_ROLLOUT_PLAN.md; DOCS/README.md; DOCS/CHANGE_CONTROL_LOG.md |
| 2025-12-11 | Codex AI Agent | Phase 10 – Production DNS & secret migration prep: authored the DNS plan, production env migration guide, launch-run templates for production cutover, updated the Implementation Reality Map with DNS/env status, and extended the launch checklist + change log for the new governance gate. | DOCS/PRODUCTION_DNS_PLAN.md; DOCS/PRODUCTION_ENV_MIGRATION.md; DOCS/IMPLEMENTATION_REALITY_MAP.md; DOCS/LAUNCH_READY_CHECKLIST.md; DOCS/launch_runs/launch-production-20251211-preflight.md; DOCS/db/MIGRATIONS_INDEX.md; DOCS/CHANGE_CONTROL_LOG.md |
